"use strict";
var Promise = require("bluebird");
var superagent = require("superagent");
function timeSynced(interval) {
    return new Promise(function (resolve, reject) {
        function checkTime() {
            return new Promise(function (resolve, reject) {
                superagent.get("https://io.kernel.online/date").end(function (err, res) {
                    if (err) {
                        reject(err);
                    }
                    else {
                        if (new Date().getTime() > (res.body.unixtime - 90000)) {
                            resolve(true);
                        }
                        else {
                            reject('not now');
                        }
                    }
                });
            });
        }
        if (!interval)
            interval = 5000;
        checkTime().then(function () {
            resolve(true);
        }).catch(function (err) {
            var startcheck = setInterval(function () {
                checkTime().then(function () {
                    clearInterval(startcheck);
                    resolve(true);
                });
            }, interval);
        });
    });
}
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = timeSynced;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFZLE9BQU8sV0FBTSxVQUFVLENBQUMsQ0FBQTtBQUNwQyxJQUFZLFVBQVUsV0FBTSxZQUFZLENBQUMsQ0FBQTtBQUl6QyxvQkFBbUMsUUFBaUI7SUFDaEQsTUFBTSxDQUFDLElBQUksT0FBTyxDQUFDLFVBQUMsT0FBTyxFQUFFLE1BQU07UUFHL0I7WUFDSSxNQUFNLENBQUMsSUFBSSxPQUFPLENBQVUsVUFBQyxPQUFPLEVBQUUsTUFBTTtnQkFFeEMsVUFBVSxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLEdBQUcsRUFBRSxHQUFHO29CQUV6RCxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO3dCQUNOLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtvQkFDZixDQUFDO29CQUFDLElBQUksQ0FBQyxDQUFDO3dCQUNKLEVBQUUsQ0FBQyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQ3JELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQzt3QkFDbEIsQ0FBQzt3QkFBQyxJQUFJLENBQUMsQ0FBQzs0QkFDSixNQUFNLENBQUMsU0FBUyxDQUFDLENBQUE7d0JBQ3JCLENBQUM7b0JBQ0wsQ0FBQztnQkFHTCxDQUFDLENBQUMsQ0FBQTtZQUNOLENBQUMsQ0FBQyxDQUFBO1FBRU4sQ0FBQztRQUdELEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO1lBQUMsUUFBUSxHQUFHLElBQUksQ0FBQTtRQUU5QixTQUFTLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDYixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUE7UUFFakIsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQUMsR0FBRztZQUVULElBQU0sVUFBVSxHQUFHLFdBQVcsQ0FBQztnQkFDM0IsU0FBUyxFQUFFLENBQUMsSUFBSSxDQUFDO29CQUNiLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQTtvQkFDekIsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUNqQixDQUFDLENBQUMsQ0FBQTtZQUNOLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQTtRQUVoQixDQUFDLENBQUMsQ0FBQTtJQUdOLENBQUMsQ0FBQyxDQUFBO0FBQ04sQ0FBQztBQTVDRDs0QkE0Q0MsQ0FBQSIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFByb21pc2UgZnJvbSBcImJsdWViaXJkXCI7XG5pbXBvcnQgKiBhcyBzdXBlcmFnZW50IGZyb20gXCJzdXBlcmFnZW50XCI7XG5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB0aW1lU3luY2VkKGludGVydmFsPzogbnVtYmVyKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuXG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrVGltZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxib29sZWFuPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgICAgICAgICAgICBzdXBlcmFnZW50LmdldChcImh0dHBzOi8vaW8ua2VybmVsLm9ubGluZS9kYXRlXCIpLmVuZCgoZXJyLCByZXMpID0+IHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ldyBEYXRlKCkuZ2V0VGltZSgpID4gKHJlcy5ib2R5LnVuaXh0aW1lIC0gOTAwMDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdub3Qgbm93JylcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcblxuICAgICAgICB9XG5cblxuICAgICAgICBpZiAoIWludGVydmFsKSBpbnRlcnZhbCA9IDUwMDBcblxuICAgICAgICBjaGVja1RpbWUoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUodHJ1ZSlcblxuICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG5cbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0Y2hlY2sgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY2hlY2tUaW1lKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoc3RhcnRjaGVjaylcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9LCBpbnRlcnZhbClcblxuICAgICAgICB9KVxuXG5cbiAgICB9KVxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
