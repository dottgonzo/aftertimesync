"use strict";
var Promise = require("bluebird");
var superagent = require("superagent");
function timeSynced(interval) {
    return new Promise(function (resolve, reject) {
        function checkTime() {
            return new Promise(function (resolve, reject) {
                superagent.get("https://io.kernel.online/date").end(function (err, res) {
                    if (err) {
                        reject(err);
                    }
                    else {
                        if (new Date().getTime() > (res.body.unixtime - 90000)) {
                            resolve(true);
                        }
                        else {
                            reject('not now');
                        }
                    }
                });
            });
        }
        if (!interval)
            interval = 5000;
        checkTime().then(function () {
            resolve(true);
        }).catch(function (err) {
            var startcheck = setInterval(function () {
                checkTime().then(function () {
                    clearInterval(startcheck);
                    resolve(true);
                });
            }, interval);
        });
    });
}
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = timeSynced;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFZLE9BQU8sV0FBTSxVQUFVLENBQUMsQ0FBQTtBQUNwQyxJQUFZLFVBQVUsV0FBTSxZQUFZLENBQUMsQ0FBQTtBQUl6QyxvQkFBbUMsUUFBaUI7SUFDaEQsTUFBTSxDQUFDLElBQUksT0FBTyxDQUFVLFVBQUMsT0FBTyxFQUFFLE1BQU07UUFHeEM7WUFDSSxNQUFNLENBQUMsSUFBSSxPQUFPLENBQVUsVUFBQyxPQUFPLEVBQUUsTUFBTTtnQkFFeEMsVUFBVSxDQUFDLEdBQUcsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLEdBQUcsRUFBRSxHQUFHO29CQUV6RCxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO3dCQUNOLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtvQkFDZixDQUFDO29CQUFDLElBQUksQ0FBQyxDQUFDO3dCQUNKLEVBQUUsQ0FBQyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQ3JELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQzt3QkFDbEIsQ0FBQzt3QkFBQyxJQUFJLENBQUMsQ0FBQzs0QkFDSixNQUFNLENBQUMsU0FBUyxDQUFDLENBQUE7d0JBQ3JCLENBQUM7b0JBQ0wsQ0FBQztnQkFHTCxDQUFDLENBQUMsQ0FBQTtZQUNOLENBQUMsQ0FBQyxDQUFBO1FBRU4sQ0FBQztRQUdELEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO1lBQUMsUUFBUSxHQUFHLElBQUksQ0FBQTtRQUU5QixTQUFTLEVBQUUsQ0FBQyxJQUFJLENBQUM7WUFDYixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUE7UUFFakIsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQUMsR0FBRztZQUVULElBQU0sVUFBVSxHQUFHLFdBQVcsQ0FBQztnQkFDM0IsU0FBUyxFQUFFLENBQUMsSUFBSSxDQUFDO29CQUNiLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQTtvQkFDekIsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUNqQixDQUFDLENBQUMsQ0FBQTtZQUNOLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQTtRQUVoQixDQUFDLENBQUMsQ0FBQTtJQUdOLENBQUMsQ0FBQyxDQUFBO0FBQ04sQ0FBQztBQTVDRDs0QkE0Q0MsQ0FBQSIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFByb21pc2UgZnJvbSBcImJsdWViaXJkXCI7XG5pbXBvcnQgKiBhcyBzdXBlcmFnZW50IGZyb20gXCJzdXBlcmFnZW50XCI7XG5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB0aW1lU3luY2VkKGludGVydmFsPzogbnVtYmVyKTpQcm9taXNlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8Ym9vbGVhbj4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG5cbiAgICAgICAgZnVuY3Rpb24gY2hlY2tUaW1lKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPGJvb2xlYW4+KChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgICAgICAgICAgIHN1cGVyYWdlbnQuZ2V0KFwiaHR0cHM6Ly9pby5rZXJuZWwub25saW5lL2RhdGVcIikuZW5kKChlcnIsIHJlcykgPT4ge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3IERhdGUoKS5nZXRUaW1lKCkgPiAocmVzLmJvZHkudW5peHRpbWUgLSA5MDAwMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ25vdCBub3cnKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIH1cblxuXG4gICAgICAgIGlmICghaW50ZXJ2YWwpIGludGVydmFsID0gNTAwMFxuXG4gICAgICAgIGNoZWNrVGltZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKVxuXG4gICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcblxuICAgICAgICAgICAgY29uc3Qgc3RhcnRjaGVjayA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjaGVja1RpbWUoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChzdGFydGNoZWNrKVxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sIGludGVydmFsKVxuXG4gICAgICAgIH0pXG5cblxuICAgIH0pXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
